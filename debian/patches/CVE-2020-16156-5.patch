From c03257dbebccd4deeff1987d5efd98113643f717 Mon Sep 17 00:00:00 2001
From: Andreas Koenig <andk@cpan.org>
Date: Mon, 22 Nov 2021 13:55:38 +0100
Subject: [PATCH] disambiguate the call to gpg --output by adding --verify

-- thanks to Stig Palmquist for the suggestion
---
 lib/CPAN/Distribution.pm | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: perl-5.30.0/cpan/CPAN/lib/CPAN/Distribution.pm
===================================================================
--- perl-5.30.0.orig/cpan/CPAN/lib/CPAN/Distribution.pm
+++ perl-5.30.0/cpan/CPAN/lib/CPAN/Distribution.pm
@@ -1521,7 +1521,7 @@ sub CHECKSUM_check_file {
         unlink $tempfile; # ignore missing file
         my $gpg = $CPAN::Config->{gpg} or
             $CPAN::Frontend->mydie("Your configuration suggests that you do not have 'gpg' installed. This is needed to verify checksums with the config variable 'check_sigs' on. Please configure it with 'o conf init gpg'");
-        my $system = "gpg --batch --no-tty --output $tempfile $chk_file 2> /dev/null";
+        my $system = "gpg --verify --batch --no-tty --output $tempfile $chk_file 2> /dev/null";
         0 == system $system or $CPAN::Frontend->mydie("gpg run was failing, cannot continue: $system");
         open $fh, $tempfile or $CPAN::Frontend->mydie("Could not open $tempfile: $!");
         local $/;
